<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>API Test Page</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f9f9f9;
            color: #333;
        }
        main {
            max-width: 700px;
            margin: 0 auto;
        }
        fieldset {
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
            background-color: #fff;
        }
        legend {
            font-size: 1.2em;
            font-weight: 600;
            padding: 0 10px;
        }
        div {
            margin-bottom: 15px;
        }
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: 500;
        }
        input[type="text"],
        input[type="password"],
        select,
        textarea {
            width: 100%;
            padding: 10px;
            box-sizing: border-box;
            border: 1px solid #ccc;
            border-radius: 4px;
            font-size: 1em;
        }
        textarea {
            min-height: 120px;
            resize: vertical;
        }
        button {
            background-color: #007aff;
            color: white;
            padding: 12px 18px;
            border: none;
            border-radius: 6px;
            font-size: 1em;
            cursor: pointer;
            transition: background-color 0.2s;
        }
        button:hover {
            background-color: #0056b3;
        }
        pre {
            background-color: #282c34;
            color: #abb2bf;
            padding: 20px;
            border-radius: 8px;
            overflow-x: auto;
            white-space: pre-wrap;
            word-wrap: break-word;
        }
        #keyStatus {
            font-style: italic;
            color: #555;
        }
    </style>
</head>
<body>
    <main>
        <fieldset>
            <legend>API Key Management</legend>
            <div>
                <label for="apiKey">Your API Key:</label>
                <input type="password" id="apiKey" placeholder="Enter your API key">
            </div>
            <button id="saveKeyBtn">Save Key to Cookies</button>
            <p id="keyStatus">No key found in cookies.</p>
        </fieldset>

        <fieldset>
            <legend>AI Humanizer</legend>
            <form id="humanizeForm">
                <div>
                    <label for="humanizeText">Text to Humanize:</label>
                    <textarea id="humanizeText" required>This is a sample text generated by an AI.</textarea>
                </div>
                <div>
                    <label for="humanizerIntensity">Intensity:</label>
                    <select id="humanizerIntensity">
                        <option value="LOW">LOW</option>
                        <option value="MEDIUM" selected>MEDIUM</option>
                        <option value="HIGH">HIGH</option>
                    </select>
                </div>
                <button type="submit">Humanize Text</button>
            </form>
        </fieldset>

        <fieldset>
            <legend>AI Detector</legend>
            <form id="detectForm">
                <div>
                    <label for="detectText">Text to Detect:</label>
                    <textarea id="detectText" required>This text will be analyzed for its origin.</textarea>
                </div>
                <button type="submit">Detect AI</button>
            </form>
        </fieldset>

        <fieldset>
            <legend>API Response</legend>
            <pre id="apiResult">Responses will appear here...</pre>
        </fieldset>
    </main>

    <script>
        // --- Cookie Helper Functions ---
        function setCookie(name, value, days) {
            let expires = "";
            if (days) {
                const date = new Date();
                date.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000));
                expires = "; expires=" + date.toUTCString();
            }
            document.cookie = name + "=" + (value || "") + expires + "; path=/; SameSite=Lax";
        }

        function getCookie(name) {
            const nameEQ = name + "=";
            const ca = document.cookie.split(';');
            for (let i = 0; i < ca.length; i++) {
                let c = ca[i];
                while (c.charAt(0) === ' ') c = c.substring(1, c.length);
                if (c.indexOf(nameEQ) === 0) return c.substring(nameEQ.length, c.length);
            }
            return null;
        }

        // --- DOM Elements ---
        const saveKeyBtn = document.getElementById('saveKeyBtn');
        const apiKeyInput = document.getElementById('apiKey');
        const keyStatus = document.getElementById('keyStatus');
        
        const humanizeForm = document.getElementById('humanizeForm');
        const detectForm = document.getElementById('detectForm');
        const apiResult = document.getElementById('apiResult');

        // --- API Base URLs ---
        const HUMANIZER_URL = 'https://www.the-ghost-ai-api.com/transformations/humanize-v2/';
        const DETECTOR_URL = 'https://www.the-ghost-ai-api.com/detection/ai-v2/';

        // --- Key Management ---
        function checkKeyStatus() {
            const key = getCookie('apiKey');
            if (key) {
                keyStatus.textContent = 'API key is saved in cookies.';
                keyStatus.style.color = 'green';
            } else {
                keyStatus.textContent = 'No key found in cookies.';
                keyStatus.style.color = 'red';
            }
        }

        saveKeyBtn.addEventListener('click', () => {
            const key = apiKeyInput.value;
            if (key) {
                setCookie('apiKey', key, 7); // Save for 7 days
                apiKeyInput.value = '';
                checkKeyStatus();
                alert('API Key saved to cookies!');
            } else {
                alert('Please enter an API key.');
            }
        });

        // --- Generic API Call Function ---
        async function makeApiCall(url, body) {
            const apiKey = getCookie('apiKey');
            if (!apiKey) {
                alert('No API key found in cookies. Please save your key first.');
                return;
            }

            apiResult.textContent = 'Loading...';

            try {
                const response = await fetch(url, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': 'Api-Key ' + apiKey
                    },
                    body: JSON.stringify(body)
                });

                const data = await response.json();
                apiResult.textContent = JSON.stringify(data, null, 2);

            } catch (error) {
                console.error('API Call Error:', error);
                apiResult.textContent = `Error: ${error.message}`;
            }
        }

        // --- Form Event Listeners ---
        humanizeForm.addEventListener('submit', (e) => {
            e.preventDefault();
            const text = document.getElementById('humanizeText').value;
            const humanizerIntensity = document.getElementById('humanizerIntensity').value;
            makeApiCall(HUMANIZER_URL, { text, humanizerIntensity });
        });

        detectForm.addEventListener('submit', (e) => {
            e.preventDefault();
            const text = document.getElementById('detectText').value;
            makeApiCall(DETECTOR_URL, { text });
        });

        // --- Initial Check on Load ---
        document.addEventListener('DOMContentLoaded', checkKeyStatus);
    </script>
</body>
</html>
